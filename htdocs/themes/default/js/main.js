!function(){"use strict";if("querySelectorAll"in document&&"addEventListener"in window){window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,o=(this.document||this.ownerDocument).querySelectorAll(e),n=this;do{for(t=o.length;--t>=0&&o.item(t)!==n;);}while(t<0&&(n=n.parentElement));return n}),window.history&&!window.history.pushState&&(window.history.pushState=function(e,t,o){return[e,t,o]}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var o=0;o<this.length;o++)e.call(t,this[o],o,this)});var e={el:null,create:function(){this.el=document.createElement("div"),this.el.setAttribute("class","image-popup"),this.el.innerHTML='<img src="#" alt="" />',document.body.appendChild(this.el),document.body.addEventListener("click",e.remove),document.addEventListener("keyup",e.removeOnEsc),window.onpopstate=function(t){t.state&&t.state.image?(e.el||e.create(),e.setImage(t.state.image,!0)):e.el&&e.remove(t,!0)}},remove:function(t,o){t.preventDefault(),t.stopPropagation(),document.body.removeEventListener("click",e.remove),document.removeEventListener("keyup",e.removeOnEsc),document.body.removeChild(e.el),e.el=null,o||history.pushState({},"",window.location.pathname)},removeOnEsc:function(t){27===t.keyCode&&e.remove(t)},setImage:function(e,t){this.el.getElementsByTagName("img")[0].setAttribute("src",e),t||history.pushState({image:e},"","#"+e)}};document.querySelectorAll("[data-ajax-url]").forEach(function(e){if(e.getAttribute("data-ajax-url")){var t=new XMLHttpRequest;t.open("GET",e.getAttribute("data-ajax-url"),!0),t.onload=function(){this.status>=200&&this.status<400&&(e.outerHTML=this.response)},t.send()}}),document.body.addEventListener("click",function(t){var o=t.target.closest("a.gallery__link");o&&o.getAttribute("href")&&(t.preventDefault(),t.stopPropagation(),e.el||e.create(),e.setImage(o.getAttribute("href")))})}}();